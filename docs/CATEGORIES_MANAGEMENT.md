# ุฅุฏุงุฑุฉ ุงูุชุตูููุงุช

## ูุธุฑุฉ ุนุงูุฉ

ุงูุชุตูููุงุช ูู ุงูููุตุฉ ุชูุฎุฒู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (Supabase) ููููู ุฅุฏุงุฑุชูุง ูุจุงุดุฑุฉ ูู ููุงู. ุงูุชุทุจูู ูุฌูุจ ุงูุชุตูููุงุช ุชููุงุฆูุงู ูู ุงูุจุงู ุงูุฏ ููุนุฑุถูุง ูู ุฌููุน ุงููุงุฌูุงุช.

## ูููู ุฌุฏูู ุงูุชุตูููุงุช

ุฌุฏูู `categories` ูู Supabase ูุญุชูู ุนูู ุงูุฃุนูุฏุฉ ุงูุชุงููุฉ:

- `id` (TEXT PRIMARY KEY): ูุนุฑู ูุฑูุฏ ููุชุตููู (ูุซู: 'tech', 'design')
- `label` (TEXT): ุงูุงุณู ุงูุนุฑุจู ููุชุตููู (ูุซู: 'ุฎุฏูุงุช ุชูููุฉ ูุจุฑูุฌุฉ')
- `emoji` (TEXT): ุงูุฅูููุฌู ุงููุฑุชุจุท ุจุงูุชุตููู (ูุซู: '๐ป')
- `description` (TEXT): ูุตู ุงูุชุตููู (ุงุฎุชูุงุฑู)
- `is_active` (BOOLEAN): ูู ุงูุชุตููู ูุดุท ุฃู ูุง (ุงูุชุฑุงุถูุงู: TRUE)
- `sort_order` (INTEGER): ุชุฑุชูุจ ุงูุนุฑุถ (ุงูุชุฑุงุถูุงู: 0)
- `created_at` (TIMESTAMPTZ): ุชุงุฑูุฎ ุงูุฅูุดุงุก
- `updated_at` (TIMESTAMPTZ): ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ

## ููููุฉ ุฅุถุงูุฉ ุชุตููู ุฌุฏูุฏ

### ุงูุทุฑููุฉ 1: ูู Supabase Dashboard (ุงูุฃุณูู)

1. ุงูุชุญ Supabase Dashboard
2. ุงุฐูุจ ุฅูู **Table Editor** โ ุฌุฏูู `categories`
3. ุงุถุบุท ุนูู **Insert row** ุฃู **+ New row**
4. ุงููุฃ ุงูุจูุงูุงุช:
   - `id`: ูุนุฑู ูุฑูุฏ (ูุซู: 'new-category')
   - `label`: ุงูุงุณู ุงูุนุฑุจู (ูุซู: 'ุชุตููู ุฌุฏูุฏ')
   - `emoji`: ุงูุฅูููุฌู (ูุซู: '๐ฏ')
   - `description`: ุงููุตู (ุงุฎุชูุงุฑู)
   - `is_active`: TRUE
   - `sort_order`: ุฑูู ุงูุชุฑุชูุจ (ูุซู: 20)
5. ุงุญูุธ ุงูุชุบููุฑุงุช

**ุงููุชูุฌุฉ**: ุงูุชุตููู ุณูุธูุฑ ุชููุงุฆูุงู ูู ุงูุชุทุจูู ุฎูุงู 5 ุฏูุงุฆู (ูุฏุฉ ุงูู cache) ุฃู ุนูุฏ ุฅุนุงุฏุฉ ุชุญููู ุงูุชุทุจูู.

### ุงูุทุฑููุฉ 2: ูู SQL Editor ูู Supabase

**โ๏ธ ููู**: ุชุฃูุฏ ูู ุฃูู ูู ุฌุฏูู `categories` ูููุณ `request_categories`!

```sql
INSERT INTO categories (id, label, emoji, description, is_active, sort_order)
VALUES (
  'consulting',                    -- ID ูุฑูุฏ (TEXTุ ููุณ UUID!)
  'ุงุณุชุดุงุฑุงุช ููููุฉ',                -- ุงูุงุณู ุงูุนุฑุจู
  '๐ผ',                            -- ุงูุฅูููุฌู
  'ุงุณุชุดุงุฑุงุช ูู ูุฎุชูู ุงููุฌุงูุงุช',     -- ุงููุตู (ุงุฎุชูุงุฑู)
  TRUE,                            -- ูุดุท
  25                               -- ุชุฑุชูุจ ุงูุนุฑุถ
);
```

**ููุงุญุธุฉ**: ุฅุฐุง ุธูุฑ ุฎุทุฃ `invalid input syntax for type uuid`ุ ุชุฃูุฏ ูู:
1. ุฃูู ูู ุฌุฏูู `categories` ูููุณ `request_categories`
2. ุฃู ุงูู `id` ูู TEXT ูููุณ UUID
3. ุฃูู ูุง ุชุญุงูู ุฅุฏุฑุงุฌ ูู ุนููุฏ `request_id` (ูุฐุง UUID)

### ุงูุทุฑููุฉ 3: ูู ุงูููุฏ (ูููุทูุฑูู)

ููููู ุฅุถุงูุฉ ุชุตูููุงุช ุฌุฏูุฏุฉ ูู ููู `supabase/CATEGORIES_AND_NOTIFICATIONS_SETUP.sql`:

```sql
INSERT INTO categories (id, label, emoji, description, sort_order) VALUES
  ('new-category', 'ุชุตููู ุฌุฏูุฏ', '๐ฏ', 'ูุตู ุงูุชุตููู', 20)
ON CONFLICT (id) DO UPDATE SET
  label = EXCLUDED.label,
  emoji = EXCLUDED.emoji,
  description = EXCLUDED.description,
  sort_order = EXCLUDED.sort_order,
  updated_at = NOW();
```

ุซู ุดุบูู ุงูู SQL script ูู Supabase Dashboard.

## ุงูุฃููุงู ุงูุชููุงุฆูุฉ

ูู ุชุตููู ูุญุตู ุนูู ููู ุชููุงุฆูุงู ุจูุงุกู ุนูู ุงูู `id` ุงูุฎุงุต ุจู. ุงูุฃููุงู ูุญุฏุฏุฉ ูู `utils/categoryColors.ts`:

- ุงูุชุตูููุงุช ุงููุนุฑููุฉ ููุง ุฃููุงู ุซุงุจุชุฉ (ูุซู: tech = ุฃุฒุฑูุ design = ุจููุณุฌู)
- ุงูุชุตูููุงุช ุงูุฌุฏูุฏุฉ ุชุญุตู ุนูู ููู ุชููุงุฆูุงู ุจุงุณุชุฎุฏุงู hash function

### ุฅุถุงูุฉ ููู ูุฎุตุต ูุชุตููู ุฌุฏูุฏ

ุฅุฐุง ุฃุฑุฏุช ุชุญุฏูุฏ ููู ูุญุฏุฏ ูุชุตููู ุฌุฏูุฏุ ุนุฏูู ููู `utils/categoryColors.ts`:

```typescript
const knownColors: Record<string, string> = {
  // ... ุงูุชุตูููุงุช ุงูููุฌูุฏุฉ
  'new-category': 'border-blue-200 dark:border-blue-800 bg-blue-50/50 dark:bg-blue-950/30 text-blue-700 dark:text-blue-300',
};
```

## ุชุญุฏูุซ ุงูุชุตูููุงุช

### ุชุญุฏูุซ ุชุตููู ููุฌูุฏ

```sql
UPDATE categories
SET 
  label = 'ุงุณู ุฌุฏูุฏ',
  emoji = '๐',
  description = 'ูุตู ูุญุฏุซ',
  sort_order = 15,
  updated_at = NOW()
WHERE id = 'tech';
```

### ุฅูุบุงุก ุชูุนูู ุชุตููู (ุจุฏูู ุญุฐูู)

```sql
UPDATE categories
SET is_active = FALSE, updated_at = NOW()
WHERE id = 'old-category';
```

**ููุงุญุธุฉ**: ุงูุชุตูููุงุช ุบูุฑ ุงููุดุทุฉ (`is_active = FALSE`) ูู ุชุธูุฑ ูู ุงูุชุทุจูู.

## ุญุฐู ุชุตููู

โ๏ธ **ุชุญุฐูุฑ**: ุญุฐู ุชุตููู ุณูุคุซุฑ ุนูู ุฌููุน ุงูุทูุจุงุช ุงููุฑุชุจุทุฉ ุจู!

```sql
-- ุฃููุงู: ุชุญูู ูู ุงูุทูุจุงุช ุงููุฑุชุจุทุฉ
SELECT COUNT(*) FROM request_categories WHERE category_id = 'category-to-delete';

-- ุฅุฐุง ูุงู ุงูุนุฏุฏ = 0ุ ููููู ุงูุญุฐู ุจุฃูุงู
DELETE FROM categories WHERE id = 'category-to-delete';
```

**ุจุฏูู ุขูู**: ุงุณุชุฎุฏู `is_active = FALSE` ุจุฏูุงู ูู ุงูุญุฐู.

## ุงูู Cache

ุงูุชุทุจูู ูุณุชุฎุฏู cache ููุฏุฉ 5 ุฏูุงุฆู ูุชูููู ุงูุทูุจุงุช ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. ุนูุฏ ุฅุถุงูุฉ ุฃู ุชุญุฏูุซ ุชุตููู:

- ุงูุชุบููุฑุงุช ุณุชุธูุฑ ุฎูุงู 5 ุฏูุงุฆู ุชููุงุฆูุงู
- ุฃู ูููู ุฅุนุงุฏุฉ ุชุญููู ุงูุชุทุจูู ูุฑุคูุฉ ุงูุชุบููุฑุงุช ููุฑุงู
- ุงูุชุทุจูู ูุดุชุฑู ูู ุชุญุฏูุซุงุช ุงูุชุตูููุงุช (Realtime) ูู Supabase

## ุงูุชุตูููุงุช ุงูููุชุฑุญุฉ (Pending Categories)

ูููู ูููุณุชุฎุฏููู ุงูุชุฑุงุญ ุชุตูููุงุช ุฌุฏูุฏุฉ ูู ุฎูุงู ุงูุชุทุจูู. ูุฐู ุงูุงูุชุฑุงุญุงุช ุชูุฎุฒู ูู ุฌุฏูู `pending_categories` ููููู ูููุณุคูููู ุงูููุงููุฉ ุนูููุง ุฃู ุฑูุถูุง ูู Supabase Dashboard.

## ุฃูุซูุฉ ุนูู ุงูุชุตูููุงุช

```sql
-- ูุซุงู: ุฅุถุงูุฉ ุชุตููู ุฌุฏูุฏ
INSERT INTO categories (id, label, emoji, description, sort_order) VALUES
  ('consulting', 'ุงุณุชุดุงุฑุงุช ููููุฉ', '๐ผ', 'ุงุณุชุดุงุฑุงุช ูู ูุฎุชูู ุงููุฌุงูุงุช', 25);

-- ูุซุงู: ุชุญุฏูุซ ุชุตููู ููุฌูุฏ
UPDATE categories
SET emoji = '๐ป', description = 'ุชุทููุฑ ุงูููุงูุน ูุงูุชุทุจููุงุช ูุงูุฃูุธูุฉ'
WHERE id = 'tech';

-- ูุซุงู: ุฅุนุงุฏุฉ ุชุฑุชูุจ ุงูุชุตูููุงุช
UPDATE categories SET sort_order = 1 WHERE id = 'tech';
UPDATE categories SET sort_order = 2 WHERE id = 'design';
UPDATE categories SET sort_order = 3 WHERE id = 'writing';
```

## ูุตุงุฆุญ

1. **ุงุณุชุฎุฏู IDs ูุงุถุญุฉ**: ุงุณุชุฎุฏู ุฃุณูุงุก ุฅูุฌููุฒูุฉ ูุงุถุญุฉ ููู IDs (ูุซู: 'tech', 'design')
2. **ุชุฑุชูุจ ููุทูู**: ุงุณุชุฎุฏู `sort_order` ูุชุฑุชูุจ ุงูุชุตูููุงุช ุญุณุจ ุงูุฃูููุฉ
3. **ุฅูููุฌู ููุงุณุจ**: ุงุฎุชุฑ ุฅูููุฌู ูุนุจุฑ ุนู ุงูุชุตููู ุจูุถูุญ
4. **ูุง ุชุญุฐู**: ุงุณุชุฎุฏู `is_active = FALSE` ุจุฏูุงู ูู ุงูุญุฐู ููุญูุงุธ ุนูู ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ
5. **ุงุฎุชุจุฑ**: ุจุนุฏ ุฅุถุงูุฉ ุชุตููู ุฌุฏูุฏุ ุงุฎุชุจุฑู ูู ุงูุชุทุจูู ููุชุฃูุฏ ูู ุธููุฑู ุจุดูู ุตุญูุญ

## ุงูุฏุนู ุงูููู

ุฅุฐุง ูุงุฌูุช ูุดุงูู ูู ุฅุฏุงุฑุฉ ุงูุชุตูููุงุช:
1. ุชุญูู ูู ุฃู ุงูุชุตููู `is_active = TRUE`
2. ุชุญูู ูู ุฃู ุงูู `id` ูุฑูุฏ ููุง ูุชูุฑุฑ
3. ุชุฃูุฏ ูู ุฃู ุงูุชุทุจูู ูุชุตู ุจุงูุฅูุชุฑูุช
4. ุฃุนุฏ ุชุญููู ุงูุชุทุจูู ุจุนุฏ ุฅุถุงูุฉ ุงูุชุตููู

