# โ ุชู ุฅููุงู ุงูุชูููุฐ - ูุธุงู ุงูุฅุดุนุงุฑุงุช ูุงููุฑุงูุจุฉ ุงููุชูุฏู

## ๐ฏ ูุง ุชู ุฅูุฌุงุฒู

### โ ุงููุฑุญูุฉ 1: ูุธุงู ุชุชุจุน ุงููุฑุงุกุฉ
- [x] ุฅูุดุงุก ุฌุฏูู `request_views` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [x] ุฅูุดุงุก Functions: `mark_request_viewed`, `mark_request_read`, `get_unread_interests_count`
- [x] ุฅูุดุงุก Service: `requestViewsService.ts`
- [x] ุฑุจุท ูุธุงู ุงููุฑุงุกุฉ ุจูุชุญ `RequestDetail` (ุชุญุฏูุฏ ููุดุงูุฏ ุนูุฏ ุงููุชุญุ ูููุฑูุก ุนูุฏ ุงูุชูุฑูุฑ 50%)

### โ ุงููุฑุญูุฉ 2: ูุธุงู ุงููุฑุงูุจุฉ ุงูุฐูู (Interests Only)
- [x] ุชุนุฏูู `subscribeToNewRequests` ููููู ููุท ูุตูุญุฉ "ุงูุชูุงูุงุชู"
- [x] ุฅุถุงูุฉ state ูููุตู: `interestsRequests` ู `unreadInterestsCount`
- [x] ุฑุจุท ุงููุฑุงูุจุฉ ุจู `viewMode === "interests"`
- [x] ุฅุถุงูุฉ ุนุฏุงุฏ ููุทูุจุงุช ุบูุฑ ุงูููุฑูุกุฉ ูู "ุงูุชูุงูุงุชู"
- [x] ุชุญุฏูุซ `Marketplace` component ูุงุณุชุฎุฏุงู `interestsRequests` ุนูุฏ `viewMode === "interests"`

### โ ุงููุฑุญูุฉ 3: ุชุญุณูู ุงูุฅุดุนุงุฑุงุช
- [x] ุชุญุฏูุซ `Notification` type ูุฏุนู ุจูุงูุงุช ุฅุถุงููุฉ (`relatedRequest`, `relatedOffer`, `relatedMessage`)
- [x] ุชุญุณูู ุตูุงุบุฉ ุงูุฅุดุนุงุฑุงุช ูุน ุฃุณูุงุก ุญููููุฉ ูุนูุงููู
- [x] ุชุญุฏูุซ `notificationsService` ูุฌูุจ ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ
- [x] ุฅูุดุงุก SQL triggers ูุญุณููุฉ ูุฅุดุนุงุฑุงุช ุงุญุชุฑุงููุฉ

---

## ๐ ุงููููุงุช ุงูุชู ุชู ุฅูุดุงุคูุง/ุชุนุฏูููุง

### ูููุงุช SQL ุฌุฏูุฏุฉ:
1. `supabase/REQUEST_VIEWS_SCHEMA.sql` - ูุธุงู ุชุชุจุน ุงููุฑุงุกุฉ
2. `supabase/IMPROVE_NOTIFICATIONS.sql` - ุชุญุณูู ุงูุฅุดุนุงุฑุงุช

### ูููุงุช Service ุฌุฏูุฏุฉ:
1. `services/requestViewsService.ts` - ุฎุฏูุฉ ุชุชุจุน ุงููุฑุงุกุฉ

### ูููุงุช ุชู ุชุนุฏูููุง:
1. `types.ts` - ุชุญุฏูุซ `Notification` interface
2. `App.tsx` - ุฅุถุงูุฉ `interestsRequests` ู `unreadInterestsCount` state
3. `components/Marketplace.tsx` - ุงุณุชุฎุฏุงู `interestsRequests` ูุชุญุฏูุซ ุงูุนุฏุงุฏ
4. `components/RequestDetail.tsx` - ุฑุจุท ูุธุงู ุงููุฑุงุกุฉ
5. `services/notificationsService.ts` - ุฌูุจ ุงูุจูุงูุงุช ุงูุฅุถุงููุฉ
6. `services/requestsService.ts` - ูุธุงู ุงููุฑุงูุจุฉ (ููุฌูุฏ ูุณุจูุงู)

---

## ๐ ุฎุทูุงุช ุงูุชูููุฐ ุงููุชุจููุฉ

### 1๏ธโฃ ุชุดุบูู SQL Schemas

#### ุฃ. ูุธุงู ุชุชุจุน ุงููุฑุงุกุฉ:
```sql
-- ุดุบูู ูู Supabase SQL Editor:
-- supabase/REQUEST_VIEWS_SCHEMA.sql
```

#### ุจ. ุชุญุณูู ุงูุฅุดุนุงุฑุงุช:
```sql
-- ุดุบูู ูู Supabase SQL Editor:
-- supabase/IMPROVE_NOTIFICATIONS.sql
```

### 2๏ธโฃ ุชูุนูู Realtime

ูู Supabase Dashboard:
1. ุงุฐูุจ ุฅูู **Database > Replication**
2. ุฃู ุงุณุชุฎุฏู SQL:
```sql
ALTER PUBLICATION supabase_realtime ADD TABLE requests;
ALTER PUBLICATION supabase_realtime ADD TABLE request_views;
```

### 3๏ธโฃ ุงูุชุญูู ูู ุงููุฌุงุญ

ุจุนุฏ ุชุดุบูู SQL:
```sql
-- ุชุญูู ูู ูุฌูุฏ ุงูุฌุฏุงูู
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name IN ('request_views');

-- ุชุญูู ูู ูุฌูุฏ Functions
SELECT routine_name FROM information_schema.routines 
WHERE routine_schema = 'public' 
AND routine_name LIKE '%request%view%' OR routine_name LIKE '%interest%';
```

---

## ๐จ ููู ูุนูู ุงููุธุงู

### ูุธุงู ุงููุฑุงูุจุฉ:
1. **ุนูุฏ ูุชุญ ุงูุชุทุจูู:** ูุจุฏุฃ ุงูุงุณุชูุงุน ููุทูุจุงุช ุงูุฌุฏูุฏุฉ
2. **ุนูุฏ ุฏุฎูู ุทูุจ ุฌุฏูุฏ:** ูุชุญูู ูู ุงูุชุทุงุจู ูุน ุงูุชูุงูุงุช ุงููุณุชุฎุฏู
3. **ุฅุฐุง ุชุทุงุจู:**
   - ูุถููู ูู `interestsRequests`
   - ูุฒูุฏ `unreadInterestsCount`
   - ูุฑุณู ุฅุดุนุงุฑ (ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ุฎุงุฑุฌ ุตูุญุฉ "ุงูุชูุงูุงุชู" ุฃู ุฎุงุฑุฌ ุงูุชุทุจูู)

### ูุธุงู ุงููุฑุงุกุฉ:
1. **ุนูุฏ ูุชุญ RequestDetail:** ูุญุฏุฏ ุงูุทูุจ ููุดุงูุฏ (`mark_request_viewed`)
2. **ุนูุฏ ุงูุชูุฑูุฑ 50%:** ูุญุฏุฏ ุงูุทูุจ ูููุฑูุก (`mark_request_read`)
3. **ุงูุนุฏุงุฏ:** ูุนุฑุถ ุนุฏุฏ ุงูุทูุจุงุช ุบูุฑ ุงูููุฑูุกุฉ ูู "ุงูุชูุงูุงุชู"

### ุงูุฅุดุนุงุฑุงุช:
1. **ุนุฑุถ ุฌุฏูุฏ:** "ุนุฑุถ ุฌุฏูุฏ ูู [ุงุณู ุงููุฒูุฏ] ุนูู ุทูุจู: [ุนููุงู ุงูุทูุจ]"
2. **ุฑุณุงูุฉ ุฌุฏูุฏุฉ:** "ุฑุณุงูุฉ ุฌุฏูุฏุฉ ูู [ุงุณู ุงููุฑุณู] ูู ูุญุงุฏุซุฉ: [ุนููุงู ุงูุทูุจ]"
3. **ุทูุจ ุฌุฏูุฏ ูู ุงูุชูุงูุงุชู:** "ุทูุจ ุฌุฏูุฏ: [ุนููุงู ุงูุทูุจ] ูู [ุงุณู ุงููุคูู]"
4. **ูุจูู ุนุฑุถ:** "ุชู ูุจูู ุนุฑุถู ุนูู ุทูุจ: [ุนููุงู ุงูุทูุจ]"

---

## ๐ ููุงุญุธุงุช ูููุฉ

### ุงูุฃุฏุงุก:
- โ ุงุณุชุฎุฏุงู Realtime subscriptions ุจุดูู ูุญุณูู
- โ Indexes ุนูู ูู ุงูุฃุนูุฏุฉ ุงููููุฉ
- โ Queries ูุญุณููุฉ

### ุงูุฃูุงู:
- โ RLS ููุนูู ุนูู ูู ุงูุฌุฏุงูู
- โ Functions ุชุณุชุฎุฏู `SECURITY DEFINER` ุจุดูู ุขูู
- โ ุงููุณุชุฎุฏููู ูููููู ููุท ุฑุคูุฉ ุจูุงูุงุชูู

### ุงูุชูุงูู:
- โ ูุชูุงูู ูุน ุงููุธุงู ุงููุฏูู
- โ ูุง ูุญุฐู ุจูุงูุงุช ููุฌูุฏุฉ
- โ ูุนูู ุชุฏุฑูุฌูุงู

---

## ๐ ุญู ุงููุดุงูู

### ุงููุดููุฉ: "Realtime not working"
**ุงูุญู:** ุชุฃูุฏ ูู ุชูุนูู Realtime ูู Supabase Dashboard

### ุงููุดููุฉ: "Cannot see interests requests"
**ุงูุญู:** 
1. ุชุญูู ูู ุฃู ูุฏูู ุงูุชูุงูุงุช ูุญุฏุฏุฉ (categories ุฃู cities)
2. ุชุญูู ูู ุฃู `interestsRequests` state ูุชู ุชุญุฏูุซู
3. ุชุญูู ูู console ููุฃุฎุทุงุก

### ุงููุดููุฉ: "Unread count not updating"
**ุงูุญู:**
1. ุชุญูู ูู ุฃู `get_unread_interests_count()` function ููุฌูุฏุฉ
2. ุชุญูู ูู ุฃู `request_views` table ููุฌูุฏุฉ
3. ุชุญูู ูู RLS policies

---

## โ ุญุงูุฉ ุงูุชูููุฐ

- [x] ุงููุฑุญูุฉ 1: ูุธุงู ุชุชุจุน ุงููุฑุงุกุฉ โ
- [x] ุงููุฑุญูุฉ 2: ูุธุงู ุงููุฑุงูุจุฉ ุงูุฐูู โ
- [x] ุงููุฑุญูุฉ 3: ุชุญุณูู ุงูุฅุดุนุงุฑุงุช โ
- [ ] ุงููุฑุญูุฉ 4: ุงูุฅุดุนุงุฑุงุช ุงูุฎุงุฑุฌูุฉ (Push Notifications - ูุงุญูุงู)
- [ ] ุงููุฑุญูุฉ 5: ุงูุชูุงูู ูุงูุงุฎุชุจุงุฑ (ูุญุชุงุฌ ุชุดุบูู SQL)

---

## ๐ ุงููุธุงู ุฌุงูุฒ!

ุจุนุฏ ุชุดุบูู SQL files ู ุชูุนูู Realtimeุ ุงููุธุงู ุณูุนูู ุจุดูู ูุงูู! ๐

**ุงูุฎุทูุงุช ุงูุชุงููุฉ:**
1. ุดุบูู `REQUEST_VIEWS_SCHEMA.sql`
2. ุดุบูู `IMPROVE_NOTIFICATIONS.sql`
3. ูุนูู Realtime ุนูู `requests` ู `request_views`
4. ุงุฎุชุจุฑ ุงููุธุงู!

