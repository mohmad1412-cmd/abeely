# โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ - ูุธุงู ุงูุฑุณุงุฆู ูุงูุฅุดุนุงุฑุงุช

## โ ุงูุฎุทูุงุช ุงูููุชููุฉ:

### 1. โ ุฅูุดุงุก ุงูุฌุฏุงูู
- [x] `conversations` table
- [x] `conversation_id` column ูู `messages` table
- [x] `related_message_id` ู `read_at` ูู `notifications` table
- [x] Indexes

### 2. โ ุฅูุดุงุก Functions ู Triggers
- [x] `update_conversation_on_message()` - ุชุญุฏูุซ ุงููุญุงุฏุซุฉ ุนูุฏ ุฅุฑุณุงู ุฑุณุงูุฉ
- [x] `notify_on_new_offer()` - ุฅุดุนุงุฑ ุนูุฏ ุนุฑุถ ุฌุฏูุฏ
- [x] `notify_on_offer_accepted()` - ุฅุดุนุงุฑ ุนูุฏ ูุจูู ุนุฑุถ
- [x] `notify_on_new_message()` - ุฅุดุนุงุฑ ุนูุฏ ุฑุณุงูุฉ ุฌุฏูุฏุฉ
- [x] `mark_notification_read()` - ุชุญุฏูุฏ ุฅุดุนุงุฑ ูููุฑูุก
- [x] `mark_all_notifications_read()` - ุชุญุฏูุฏ ูู ุงูุฅุดุนุงุฑุงุช ูููุฑูุกุฉ
- [x] `get_unread_notifications_count()` - ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ

### 3. โ ุฅูุดุงุก RLS Policies
- [x] Policies ูููุญุงุฏุซุงุช
- [x] Policies ููุฑุณุงุฆู
- [x] Policies ููุฅุดุนุงุฑุงุช

## ๐ง ุงูุฎุทูุฉ ุงููุชุจููุฉ (ูููุฉ):

### ุชูุนูู Realtime ูู Supabase

1. ุงุฐูุจ ุฅูู **Supabase Dashboard**
2. ุงุฎุชุฑ **Database** > **Replication**
3. ูุนูู Realtime ููุฌุฏุงูู ุงูุชุงููุฉ:
   - โ `conversations`
   - โ `messages`
   - โ `notifications`

**ุจุฏูู ุชูุนูู Realtimeุ ูู ุชุนูู ุงูููุฒุงุช ุงูุชุงููุฉ:**
- โ ุชุญุฏูุซ ุงููุญุงุฏุซุงุช ุชููุงุฆูุงู
- โ ุงุณุชูุจุงู ุงูุฑุณุงุฆู ุงูุฌุฏูุฏุฉ ููุฑุงู
- โ ุงุณุชูุจุงู ุงูุฅุดุนุงุฑุงุช ุงูุฌุฏูุฏุฉ ููุฑุงู

## ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู:

### 1. ุงุฎุชุจุงุฑ ุงููุญุงุฏุซุงุช:
```typescript
// ูู ุงูุชุทุจูู:
// 1. ุงุถุบุท ุนูู ุฒุฑ "ุงูุฑุณุงุฆู" ูู ุงูู header
// 2. ูุฌุจ ุฃู ุชุธูุฑ ูุงุฆูุฉ ุงููุญุงุฏุซุงุช (ูุงุฑุบุฉ ูู ุงูุจุฏุงูุฉ)
// 3. ุนูุฏ ุฅุฑุณุงู ุนุฑุถ ุนูู ุทูุจุ ูุฌุจ ุฃู ุชููุดุฃ ูุญุงุฏุซุฉ ุชููุงุฆูุงู
```

### 2. ุงุฎุชุจุงุฑ ุงูุฑุณุงุฆู:
```typescript
// 1. ุงูุชุญ ูุญุงุฏุซุฉ
// 2. ุฃุฑุณู ุฑุณุงูุฉ
// 3. ูุฌุจ ุฃู ุชุธูุฑ ุงูุฑุณุงูุฉ ููุฑุงู
// 4. ูุฌุจ ุฃู ูุตู ุฅุดุนุงุฑ ูููุณุชูู
```

### 3. ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช:
```typescript
// 1. ุนูุฏ ุฅุฑุณุงู ุนุฑุถ ุฌุฏูุฏ โ ูุฌุจ ุฃู ูุตู ุฅุดุนุงุฑ ูุตุงุญุจ ุงูุทูุจ
// 2. ุนูุฏ ูุจูู ุนุฑุถ โ ูุฌุจ ุฃู ูุตู ุฅุดุนุงุฑ ูุตุงุญุจ ุงูุนุฑุถ
// 3. ุนูุฏ ุฅุฑุณุงู ุฑุณุงูุฉ โ ูุฌุจ ุฃู ูุตู ุฅุดุนุงุฑ ูููุณุชูู
```

## ๐ ููุงุญุธุงุช ูููุฉ:

### ุงูุชูุงูู ูุน ุงููุธุงู ุงููุฏูู:
- โ ุงูุฑุณุงุฆู ุงููุฏููุฉ (ุจุฏูู `conversation_id`) ุณุชุนูู ุจุดูู ุทุจูุนู
- โ ุงูุฑุณุงุฆู ุงูุฌุฏูุฏุฉ (ูุน `conversation_id`) ุณุชุนูู ูุน ูุธุงู ุงููุญุงุฏุซุงุช
- โ ูููู ุงุณุชุฎุฏุงู ุงููุธุงููู ูุนุงู

### ุงูุฃูุงู:
- โ RLS ููุนูู ุนูู ูู ุงูุฌุฏุงูู
- โ ุงููุณุชุฎุฏููู ูููููู ููุท ุฑุคูุฉ ูุญุงุฏุซุงุชูู ูุฑุณุงุฆููู ูุฅุดุนุงุฑุงุชูู
- โ Functions ุชุณุชุฎุฏู `SECURITY DEFINER` ุจุดูู ุขูู

### ุงูุฃุฏุงุก:
- โ Indexes ุนูู ูู ุงูุฃุนูุฏุฉ ุงููููุฉ
- โ Realtime subscriptions ูุญุณููุฉ
- โ Queries ูุญุณููุฉ

## ๐ ุญู ุงููุดุงูู:

### ุงููุดููุฉ: "Realtime not working"
**ุงูุญู:** ุชุฃูุฏ ูู ุชูุนูู Realtime ูู Supabase Dashboard

### ุงููุดููุฉ: "Cannot see conversations"
**ุงูุญู:** ุชุฃูุฏ ูู ุฃู ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู ูุฃู RLS policies ููุนููุฉ

### ุงููุดููุฉ: "Notifications not appearing"
**ุงูุญู:** 
1. ุชุญูู ูู ุฃู Triggers ููุนููุฉ
2. ุชุญูู ูู ุฃู Functions ููุฌูุฏุฉ
3. ุชุญูู ูู console ููุฃุฎุทุงุก

## ๐ ุงููุธุงู ุฌุงูุฒ!

ุจุนุฏ ุชูุนูู Realtimeุ ุงููุธุงู ุณูุนูู ุจุดูู ูุงูู! ๐

