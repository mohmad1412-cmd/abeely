# ุชุนูููุงุช ุฅุถุงูุฉ ูุธุงู ุงูุฃุฑุดูุฉ ุฅูู Supabase

## ุงูุฎุทูุงุช

### 1. ุงูุชุญ Supabase Dashboard
- ุงุฐูุจ ุฅูู [Supabase Dashboard](https://app.supabase.com)
- ุงุฎุชุฑ ูุดุฑูุนู

### 2. ุงูุชุญ SQL Editor
- ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉุ ุงุถุบุท ุนูู **SQL Editor**
- ุฃู ุงุฐูุจ ูุจุงุดุฑุฉ ุฅูู: `https://app.supabase.com/project/[PROJECT_ID]/sql`

### 3. ุงูุตู SQL Schema (ููู ุฌุฏุงู: ูุฌุจ ุชูููุฐู ูู ุฌุฒุฆูู!)
- **ุงูุฌุฒุก ุงูุฃูู:** ุงูุชุญ ููู `supabase/archive_schema_part1.sql`
  - ุงูุณุฎ ุงููุญุชูู ูุงูุตูู ูู SQL Editor
  - ุงุถุบุท **RUN** ูุงูุชุธุฑ ุญุชู ููุชูู ุงูุชูููุฐ
  - **ูุฌุจ ุงูุงูุชุธุงุฑ ุญุชู ููุชูู ุชูุงูุงู!**

- **ุงูุฌุฒุก ุงูุซุงูู:** ุงูุชุญ ููู `supabase/archive_schema_part2.sql`
  - ูู **ุงุณุชุนูุงู ุฌุฏูุฏ** (New Query) ูู SQL Editor
  - ุงูุณุฎ ุงููุญุชูู ูุงูุตูู
  - ุงุถุบุท **RUN**

**โ๏ธ ููู ุฌุฏุงู:** ูุง ูููู ุชุดุบูู ุงูุฌุฒุกูู ูู ููุณ ุงููุนุงููุฉ (transaction) ูุฃู PostgreSQL ูุง ูุณูุญ ุจุงุณุชุฎุฏุงู ูููุฉ enum ุฌุฏูุฏุฉ ูู ููุณ ุงููุนุงููุฉ ุงูุชู ุชู ุฅุถุงูุชูุง ูููุง.

### 4. ุงูุชุญูู ูู ุงููุฌุงุญ
ุจุนุฏ ุงูุชูููุฐุ ูุฌุจ ุฃู ุชุฑู:
- โ Functions ุชู ุฅูุดุงุคูุง:
  - `archive_request`
  - `unarchive_request`
  - `archive_offer`
  - `unarchive_offer`
- โ Indexes ุชู ุฅูุดุงุคูุง:
  - `idx_requests_status_archived`
  - `idx_offers_status_archived`
  - `idx_requests_author_archived`
  - `idx_offers_provider_archived`

### 5. ุงูุชุญูู ูู RLS Policies
ุชุฃูุฏ ูู ุฃู RLS Policies ุชุณูุญ ูููุณุชุฎุฏููู ุจู:
- ุชุญุฏูุซ ุทูุจุงุชูู ุงูุฎุงุตุฉ (`UPDATE ON requests WHERE author_id = auth.uid()`)
- ุชุญุฏูุซ ุนุฑูุถูู ุงูุฎุงุตุฉ (`UPDATE ON offers WHERE provider_id = auth.uid()`)
- ูุฑุงุกุฉ ุทูุจุงุชูู/ุนุฑูุถูู ุงููุคุฑุดูุฉ

### ููุงุญุธุงุช ูููุฉ:
1. **ุงูุญุงูุฉ `archived` ููุฌูุฏุฉ ุงูุขู** ูู:
   - `requests.status` (ูููู ุฃู ูููู: `draft`, `active`, `assigned`, `completed`, `archived`)
   - `offers.status` (ูููู ุฃู ูููู: `pending`, `accepted`, `rejected`, `negotiating`, `archived`)

2. **ุงููุธุงุฆู (Functions)**:
   - `archive_request(request_id, user_id)` - ูุฃุฑุดูุฉ ุทูุจ
   - `unarchive_request(request_id, user_id)` - ูุฅูุบุงุก ุฃุฑุดูุฉ ุทูุจ (ูุณุชุนูุฏ ุงูุญุงูุฉ ุฅูู `completed`)
   - `archive_offer(offer_id, user_id)` - ูุฃุฑุดูุฉ ุนุฑุถ
   - `unarchive_offer(offer_id, user_id)` - ูุฅูุบุงุก ุฃุฑุดูุฉ ุนุฑุถ (ูุณุชุนูุฏ ุงูุญุงูุฉ ุฅูู `rejected`)

3. **ุงูุฃูุงู**: ุฌููุน ุงููุธุงุฆู ุชุชุญูู ูู ุฃู ุงููุณุชุฎุฏู ูููู ุงูุทูุจ/ุงูุนุฑุถ ูุจู ุงูุฃุฑุดูุฉ

4. **ุงูุฃุฏุงุก**: ุชู ุฅุถุงูุฉ Indexes ูุชุญุณูู ุงูุฃุฏุงุก ุนูุฏ ุงูุจุญุซ ุนู ุงูุทูุจุงุช/ุงูุนุฑูุถ ุงููุคุฑุดูุฉ

### ุงุฎุชุจุงุฑ ุงููุธุงู:
1. ุงูุชุญ ุงูุชุทุจูู
2. ุฃูุดุฆ ุทูุจ ุฃู ูุฏู ุนุฑุถ
3. ุงุถุบุท ุนูู ุฃููููุฉ ุงูุฃุฑุดูู (๐ฆ) ุจุฌุงูุจ ุงูุทูุจ/ุงูุนุฑุถ
4. ุงุฐูุจ ุฅูู ูุณู "ุฃุฑุดูู ุงูุทูุจุงุช" ุฃู "ุฃุฑุดูู ุงูุนุฑูุถ" ูู ุงูุณุงูุฏุจุงุฑ
5. ูุฌุจ ุฃู ุชุฑู ุงูุทูุจ/ุงูุนุฑุถ ุงููุคุฑุดู ููุงู
6. ุงุถุบุท ุนูู "ุฅูุบุงุก ุงูุฃุฑุดูุฉ" ูุงุณุชุนุงุฏุชู

