-- ==========================================
-- ุฅุตูุงุญ ุฌุฏูู ุงูุชุตูููุงุช - Migration Script
-- ==========================================
-- ูุฐุง ุงูุณูุฑูุจุช ูุญุฐู ุงูุฌุฏูู ุงููุฏูู ููุนูุฏ ุฅูุดุงุกู ุจุงูุจููุฉ ุงูุตุญูุญุฉ
-- โ๏ธ ุชุญุฐูุฑ: ุณูุญุฐู ุฌููุน ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ!
-- ==========================================

-- ุฎุทูุฉ 1: ุญุฐู ุงูุฌุฏุงูู ุงููุฏููุฉ
DROP TABLE IF EXISTS request_categories CASCADE;
DROP TABLE IF EXISTS categories CASCADE;

-- ุฎุทูุฉ 2: ุฅูุดุงุก ุฌุฏูู ุงูุชุตูููุงุช ุงูุฌุฏูุฏ
CREATE TABLE categories (
  id TEXT PRIMARY KEY,
  label TEXT NOT NULL,           -- ุงูุนุฑุจูุฉ (ุงูุงูุชุฑุงุถู)
  label_en TEXT,                 -- ุงูุฅูุฌููุฒูุฉ
  label_ur TEXT,                 -- ุงูุฃูุฑุฏูุฉ
  icon TEXT,                     -- ุงุณู ุฃููููุฉ lucide
  emoji TEXT,                    -- fallback ููุฅูููุฌู
  description TEXT,
  is_active BOOLEAN DEFAULT TRUE,
  sort_order INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ุฎุทูุฉ 3: ุฅุถุงูุฉ ุงูุชุตูููุงุช ุงูุดุงููุฉ
INSERT INTO categories (id, label, label_en, label_ur, icon, emoji, description, sort_order) VALUES
  -- ุชูููุฉ
  ('software-dev', 'ุชุทููุฑ ุจุฑูุฌูุงุช', 'Software Development', 'ุณุงููน ูุฆุฑ ฺูููพูููน', 'Code', '๐ป', 'ุชุทููุฑ ุงูุจุฑุงูุฌ ูุงูุฃูุธูุฉ', 1),
  ('web-dev', 'ุชุทููุฑ ููุงูุน', 'Web Development', 'ูุจ ฺูููพูููน', 'Globe', '๐', 'ุชุทููุฑ ุงูููุงูุน ุงูุฅููุชุฑูููุฉ', 2),
  ('mobile-apps', 'ุชุทุจููุงุช ุฌูุงู', 'Mobile Apps', 'ููุจุงุฆู ุงูพุณ', 'Smartphone', '๐ฑ', 'ุชุทููุฑ ุชุทุจููุงุช iOS ูAndroid', 3),
  ('it-support', 'ุฏุนู ุชููู', 'IT Support', 'ุขุฆ ูน ุณูพูุฑูน', 'Headphones', '๐ง', 'ุงูุฏุนู ุงูููู ูุญู ุงููุดุงูู ุงูุชูููุฉ', 4),
  ('data-analysis', 'ุชุญููู ุจูุงูุงุช', 'Data Analysis', 'ฺูนุง ุชุฌุฒ', 'BarChart', '๐', 'ุชุญููู ุงูุจูุงูุงุช ูุงูุฅุญุตุงุฆูุงุช', 5),
  ('ai-services', 'ุฎุฏูุงุช ุฐูุงุก ุงุตุทูุงุนู', 'AI Services', 'ุง ุขุฆ ุฎุฏูุงุช', 'Brain', '๐ง', 'ุฎุฏูุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุงูุชุนูู ุงูุขูู', 6),
  
  -- ุชุตููู
  ('graphic-design', 'ุชุตููู ุฌุฑุงููู', 'Graphic Design', 'ฺฏุฑุงูฺฉ ฺุฒุงุฆู', 'Palette', '๐จ', 'ุงูุชุตููู ุงูุฌุฑุงูููู ูุงูุตูุฑ', 10),
  ('ui-ux', 'ุชุตููู ูุงุฌูุงุช', 'UI/UX Design', 'ู ุขุฆ ฺุฒุงุฆู', 'Layout', '๐', 'ุชุตููู ูุงุฌูุงุช ุงููุณุชุฎุฏู ูุชุฌุฑุจุฉ ุงููุณุชุฎุฏู', 11),
  ('logo-branding', 'ุดุนุงุฑุงุช ููููุฉ', 'Logo & Branding', 'ููฺฏู ุงูุฑ ุจุฑุงูฺูฺฏ', 'Figma', 'โจ', 'ุชุตููู ุงูุดุนุงุฑุงุช ูุงููููุฉ ุงูุจุตุฑูุฉ', 12),
  ('interior-design', 'ุชุตููู ุฏุงุฎูู', 'Interior Design', 'ุงููนุฑุฆุฑ ฺุฒุงุฆู', 'Sofa', '๐๏ธ', 'ุงูุชุตููู ุงูุฏุงุฎูู ูุงูุฏูููุฑ', 13),
  ('architectural', 'ุชุตููู ูุนูุงุฑู', 'Architectural Design', 'ุชุนูุฑุงุช ฺุฒุงุฆู', 'Building2', '๐๏ธ', 'ุงูุชุตููู ุงููุนูุงุฑู ูุงูููุฏุณู', 14),
  
  -- ูุญุชูู
  ('content-writing', 'ูุชุงุจุฉ ูุญุชูู', 'Content Writing', 'ููุงุฏ ูฺฉฺพูุง', 'FileText', '๐', 'ูุชุงุจุฉ ุงูููุงูุงุช ูุงููุญุชูู', 20),
  ('copywriting', 'ูุชุงุจุฉ ุฅุนูุงููุฉ', 'Copywriting', 'ฺฉุงูพ ุฑุงุฆูนูฺฏ', 'PenTool', 'โ๏ธ', 'ูุชุงุจุฉ ุงููุตูุต ุงูุฅุนูุงููุฉ ูุงูุชุณููููุฉ', 21),
  ('translation', 'ุชุฑุฌูุฉ', 'Translation', 'ุชุฑุฌู', 'Languages', '๐', 'ุฎุฏูุงุช ุงูุชุฑุฌูุฉ ุจูู ุงููุบุงุช', 22),
  ('voice-over', 'ุชุนููู ุตูุชู', 'Voice Over', 'ูุงุฆุณ ุงููุฑ', 'Mic', '๐๏ธ', 'ุงูุชุนููู ุงูุตูุชู ูุงูุฏูุจูุงุฌ', 23),
  ('proofreading', 'ุชุฏููู ูุบูู', 'Proofreading', 'ูพุฑูู ุฑฺูฺฏ', 'Check', 'โ๏ธ', 'ุงูุชุฏููู ุงููุบูู ูุงูุชุญุฑูุฑ', 24),
  
  -- ุชุณููู
  ('digital-marketing', 'ุชุณููู ุฑููู', 'Digital Marketing', 'ฺุฌูนู ูุงุฑฺฉูนูฺฏ', 'TrendingUp', '๐', 'ุงูุชุณููู ุงูุฑููู ูุงูุฅููุชุฑููู', 30),
  ('social-media', 'ุณูุดูุงู ููุฏูุง', 'Social Media', 'ุณูุดู ูฺุง', 'Share2', '๐ฒ', 'ุฅุฏุงุฑุฉ ุญุณุงุจุงุช ุงูุชูุงุตู ุงูุงุฌุชูุงุนู', 31),
  ('seo', 'ุชุญุณูู ูุญุฑูุงุช ุงูุจุญุซ', 'SEO', 'ุงุณ ุง ุงู', 'Search', '๐', 'ุชุญุณูู ุธููุฑ ุงูููุงูุน ูู ูุญุฑูุงุช ุงูุจุญุซ', 32),
  ('advertising', 'ุฅุนูุงูุงุช', 'Advertising', 'ุงุดุชุงุฑุงุช', 'Megaphone', '๐ฃ', 'ุงูุญููุงุช ุงูุฅุนูุงููุฉ ูุงูุชุฑููุฌูุฉ', 33),
  
  -- ุฎุฏูุงุช ููููุฉ
  ('legal-services', 'ุฎุฏูุงุช ูุงููููุฉ', 'Legal Services', 'ูุงููู ุฎุฏูุงุช', 'Scale', 'โ๏ธ', 'ุงูุงุณุชุดุงุฑุงุช ุงููุงููููุฉ ูุงูุนููุฏ', 40),
  ('accounting', 'ูุญุงุณุจุฉ', 'Accounting', 'ุงฺฉุงุคููนูฺฏ', 'Calculator', '๐งฎ', 'ุงููุญุงุณุจุฉ ูุงูุฎุฏูุงุช ุงููุงููุฉ', 41),
  ('consulting', 'ุงุณุชุดุงุฑุงุช', 'Consulting', 'ูุดุงูุฑุช', 'MessageSquare', '๐ฌ', 'ุงูุงุณุชุดุงุฑุงุช ุงูููููุฉ ูุงูุฅุฏุงุฑูุฉ', 42),
  ('hr-services', 'ููุงุฑุฏ ุจุดุฑูุฉ', 'HR Services', 'ุงฺ ุขุฑ ุฎุฏูุงุช', 'Users', '๐ฅ', 'ุฎุฏูุงุช ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ูุงูุชูุธูู', 43),
  
  -- ุชุนููู
  ('tutoring', 'ุฏุฑูุณ ุฎุตูุตูุฉ', 'Tutoring', 'ูนูุดู', 'GraduationCap', '๐', 'ุงูุฏุฑูุณ ุงูุฎุตูุตูุฉ ูุงูุชุนููู ุงููุฑุฏู', 50),
  ('online-courses', 'ุฏูุฑุงุช ุฃูููุงูู', 'Online Courses', 'ุขู ูุงุฆู ฺฉูุฑุณุฒ', 'Monitor', '๐ฅ๏ธ', 'ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ ุนุจุฑ ุงูุฅูุชุฑูุช', 51),
  ('language-learning', 'ุชุนููู ูุบุงุช', 'Language Learning', 'ุฒุจุงู ุณฺฉฺพูุง', 'BookOpen', '๐', 'ุชุนููู ุงููุบุงุช ุงูุฃุฌูุจูุฉ', 52),
  ('skills-training', 'ุชุฏุฑูุจ ููุงุฑุงุช', 'Skills Training', 'ูุฑ ฺฉ ุชุฑุจุช', 'Target', '๐ฏ', 'ุงูุชุฏุฑูุจ ุนูู ุงูููุงุฑุงุช ุงููุฎุชููุฉ', 53),
  
  -- ุตุญุฉ
  ('medical-consult', 'ุงุณุชุดุงุฑุงุช ุทุจูุฉ', 'Medical Consultation', 'ุทุจ ูุดุงูุฑุช', 'Stethoscope', '๐ฉบ', 'ุงูุงุณุชุดุงุฑุงุช ุงูุทุจูุฉ ูุงูุตุญูุฉ', 60),
  ('nutrition', 'ุชุบุฐูุฉ', 'Nutrition', 'ุบุฐุงุฆุช', 'Apple', '๐', 'ุงุณุชุดุงุฑุงุช ุงูุชุบุฐูุฉ ูุงูุญููุงุช', 61),
  ('fitness', 'ููุงูุฉ ุจุฏููุฉ', 'Fitness', 'ููนูุณ', 'Dumbbell', '๐ช', 'ุงูุชุฏุฑูุจ ุงูุฑูุงุถู ูุงูููุงูุฉ', 62),
  ('mental-health', 'ุตุญุฉ ููุณูุฉ', 'Mental Health', 'ุฐู ุตุญุช', 'Heart', 'โค๏ธ', 'ุงูุงุณุชุดุงุฑุงุช ุงูููุณูุฉ ูุงูุฏุนู ุงูุนุงุทูู', 63),
  
  -- ุตูุงูุฉ ูููุฒู
  ('plumbing', 'ุณุจุงูุฉ', 'Plumbing', 'ูพููุจูฺฏ', 'Droplet', '๐ง', 'ุฎุฏูุงุช ุงูุณุจุงูุฉ ูุฅุตูุงุญ ุงูููุงู', 70),
  ('electrical', 'ููุฑุจุงุก', 'Electrical', 'ุจุฌู', 'Zap', 'โก', 'ุฎุฏูุงุช ุงูููุฑุจุงุก ูุงูุชูุฏูุฏุงุช', 71),
  ('ac-services', 'ุชูููู', 'AC Services', 'ุง ุณ ุฎุฏูุงุช', 'Wind', 'โ๏ธ', 'ุตูุงูุฉ ูุชุฑููุจ ุงูุชูููู', 72),
  ('home-repair', 'ุฅุตูุงุญุงุช ููุฒููุฉ', 'Home Repair', 'ฺฏฺพุฑ ฺฉ ูุฑูุช', 'Hammer', '๐จ', 'ุฅุตูุงุญุงุช ุงูููุฒู ุงูุนุงูุฉ', 73),
  ('appliance-repair', 'ุตูุงูุฉ ุฃุฌูุฒุฉ', 'Appliance Repair', 'ุขูุงุช ฺฉ ูุฑูุช', 'Settings', 'โ๏ธ', 'ุตูุงูุฉ ุงูุฃุฌูุฒุฉ ุงูููุฒููุฉ', 74),
  ('painting', 'ุฏูุงูุงุช', 'Painting', 'ูพููนูฺฏ', 'Paintbrush', '๐๏ธ', 'ุฎุฏูุงุช ุงูุฏูุงู ูุงูุทูุงุก', 75),
  ('carpentry', 'ูุฌุงุฑุฉ', 'Carpentry', 'ุจฺฺพุฆ ฺฏุฑ', 'Axe', '๐ช', 'ุฃุนูุงู ุงููุฌุงุฑุฉ ูุงูุฎุดุจ', 76),
  
  -- ููู
  ('moving', 'ููู ุนูุด', 'Moving Services', 'ุณุงูุงู ููุชูู', 'Truck', '๐', 'ููู ุงูุฃุซุงุซ ูุงูุนูุด', 80),
  ('shipping', 'ุดุญู', 'Shipping', 'ุดูพูฺฏ', 'Package', '๐ฆ', 'ุฎุฏูุงุช ุงูุดุญู ูุงูุชุบููู', 81),
  ('delivery', 'ุชูุตูู', 'Delivery', 'ฺููุฑ', 'MapPin', '๐', 'ุฎุฏูุงุช ุงูุชูุตูู ุงูุณุฑูุน', 82),
  
  -- ุณูุงุฑุงุช
  ('car-repair', 'ุตูุงูุฉ ุณูุงุฑุงุช', 'Car Repair', 'ฺฏุงฺ ฺฉ ูุฑูุช', 'Car', '๐', 'ุตูุงูุฉ ูุฅุตูุงุญ ุงูุณูุงุฑุงุช', 90),
  ('car-wash', 'ุบุณูู ุณูุงุฑุงุช', 'Car Wash', 'ฺฏุงฺ ุฏฺพูุงุฆ', 'Droplets', '๐ง', 'ุบุณูู ูุชูุธูู ุงูุณูุงุฑุงุช', 91),
  ('car-rental', 'ุชุฃุฌูุฑ ุณูุงุฑุงุช', 'Car Rental', 'ฺฏุงฺ ฺฉุฑุง', 'Key', '๐', 'ุชุฃุฌูุฑ ุงูุณูุงุฑุงุช ูุงููุฑูุจุงุช', 92),
  ('driver-services', 'ุฎุฏูุงุช ุณุงุฆู', 'Driver Services', 'ฺุฑุงุฆูุฑ ุฎุฏูุงุช', 'UserCheck', '๐จโโ๏ธ', 'ุชูููุฑ ุณุงุฆู ุฎุงุต', 93),
  
  -- ููุงุณุจุงุช
  ('event-planning', 'ุชูุธูู ููุงุณุจุงุช', 'Event Planning', 'ุชูุฑุจ ฺฉ ููุตูุจ ุจูุฏ', 'Calendar', '๐', 'ุชูุธูู ุงูุญููุงุช ูุงูููุงุณุจุงุช', 100),
  ('catering', 'ุชูููู', 'Catering', 'ฺฉูนุฑูฺฏ', 'UtensilsCrossed', '๐ด', 'ุฎุฏูุงุช ุงูุชูููู ูุงูุถูุงูุฉ', 101),
  ('photography', 'ุชุตููุฑ', 'Photography', 'ูููนูฺฏุฑุงู', 'Camera', '๐ท', 'ุงูุชุตููุฑ ุงูููุชูุบุฑุงูู', 102),
  ('videography', 'ุชุตููุฑ ููุฏูู', 'Videography', 'ูฺู ฺฏุฑุงู', 'Video', '๐ฌ', 'ุชุตููุฑ ุงูููุฏูู ูุงููููุชุงุฌ', 103),
  ('entertainment', 'ุชุฑููู', 'Entertainment', 'ุชูุฑุญ', 'Music', '๐ต', 'ุฎุฏูุงุช ุงูุชุฑููู ูุงูููุณููู', 104),
  ('flowers-decor', 'ุฒููุฑ ูุชุฒููู', 'Flowers & Decor', 'ูพฺพูู ุงูุฑ ุณุฌุงููน', 'Flower', '๐', 'ุชูุณูู ุงูุฒููุฑ ูุงูุฏูููุฑ', 105),
  
  -- ุฌูุงู ูุนูุงูุฉ
  ('hair-styling', 'ุชุตููู ุดุนุฑ', 'Hair Styling', 'ุจุงููฺบ ฺฉุง ุงุณูนุงุฆู', 'Scissors', 'โ๏ธ', 'ูุต ูุชุตููู ุงูุดุนุฑ', 110),
  ('makeup', 'ูููุงุฌ', 'Makeup', 'ูฺฉ ุงูพ', 'Sparkles', '๐', 'ุฎุฏูุงุช ุงููููุงุฌ ูุงูุชุฌููู', 111),
  ('spa-massage', 'ุณุจุง ููุณุงุฌ', 'Spa & Massage', 'ุณูพุง ุงูุฑ ูุณุงุฌ', 'Flower2', '๐ธ', 'ุฎุฏูุงุช ุงูุณุจุง ูุงููุณุงุฌ', 112),
  ('nails', 'ุฃุธุงูุฑ', 'Nails', 'ูุงุฎู', 'Hand', '๐', 'ุงูุนูุงูุฉ ุจุงูุฃุธุงูุฑ ูุงููุงููููุฑ', 113),
  
  -- ุชูุธูู
  ('home-cleaning', 'ุชูุธูู ููุงุฒู', 'Home Cleaning', 'ฺฏฺพุฑ ฺฉ ุตูุงุฆ', 'Home', '๐', 'ุชูุธูู ุงูููุงุฒู ูุงูุดูู', 120),
  ('office-cleaning', 'ุชูุธูู ููุงุชุจ', 'Office Cleaning', 'ุฏูุชุฑ ฺฉ ุตูุงุฆ', 'Building', '๐ข', 'ุชูุธูู ุงูููุงุชุจ ูุงููุจุงูู', 121),
  ('laundry', 'ุบุณูู ููู', 'Laundry', 'ูุงูฺุฑ', 'Shirt', '๐', 'ุฎุฏูุงุช ุงูุบุณูู ูุงููู', 122),
  ('pest-control', 'ููุงูุญุฉ ุญุดุฑุงุช', 'Pest Control', 'ฺฉฺ ูฺฉูฺ ฺฉููนุฑูู', 'Bug', '๐', 'ููุงูุญุฉ ุงูุญุดุฑุงุช ูุงูุขูุงุช', 123),
  
  -- ุทุนุงู
  ('cooking', 'ุทุจุฎ ููุฒูู', 'Home Cooking', 'ฺฏฺพุฑ ฺฉุง ฺฉฺพุงูุง', 'ChefHat', '๐จโ๐ณ', 'ุงูุทุจุฎ ุงูููุฒูู ูุงููุฌุจุงุช', 130),
  ('baking', 'ุญูููุงุช ููุฎุจูุฒุงุช', 'Baking', 'ุจฺฉูฺฏ', 'Cake', '๐', 'ุงูุญูููุงุช ูุงููุฎุจูุฒุงุช', 131),
  ('catering-food', 'ุชูููู ุทุนุงู', 'Food Catering', 'ฺฉฺพุงู ฺฉ ฺฉูนุฑูฺฏ', 'Soup', '๐ฒ', 'ุชุฌููุฒ ุงูุทุนุงู ููููุงุณุจุงุช', 132),
  
  -- ุนูุงุฑุงุช
  ('real-estate', 'ุนูุงุฑุงุช', 'Real Estate', 'ุฑุฆู ุงุณูนูน', 'Building2', '๐๏ธ', 'ุจูุน ูุดุฑุงุก ุงูุนูุงุฑุงุช', 140),
  ('property-mgmt', 'ุฅุฏุงุฑุฉ ุนูุงุฑุงุช', 'Property Management', 'ุฌุงุฆุฏุงุฏ ฺฉุง ุงูุชุธุงู', 'KeyRound', '๐', 'ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุช ูุงูุฅูุฌุงุฑุงุช', 141),
  
  -- ุญููุงูุงุช ุฃูููุฉ
  ('pet-care', 'ุฑุนุงูุฉ ุญููุงูุงุช', 'Pet Care', 'ูพุงูุชู ุฌุงููุฑูฺบ ฺฉ ุฏฺฉฺพ ุจฺพุงู', 'Cat', '๐ฑ', 'ุฑุนุงูุฉ ุงูุญููุงูุงุช ุงูุฃูููุฉ', 150),
  ('pet-grooming', 'ุชุฌููู ุญููุงูุงุช', 'Pet Grooming', 'ูพุงูุชู ุฌุงููุฑูฺบ ฺฉ ฺฏุฑูููฺฏ', 'Sparkle', 'โจ', 'ุชุฌููู ูุชูุธูู ุงูุญููุงูุงุช', 151),
  
  -- ุฃูู ูุญูุงูุฉ
  ('security', 'ุฎุฏูุงุช ุฃูููุฉ', 'Security Services', 'ุณฺฉูุฑูน ุฎุฏูุงุช', 'Shield', '๐ก๏ธ', 'ุฎุฏูุงุช ุงูุฃูู ูุงูุญุฑุงุณุฉ', 160),
  ('cctv', 'ูุงููุฑุงุช ูุฑุงูุจุฉ', 'CCTV Installation', 'ุณ ุณ ูน ู', 'Cctv', '๐น', 'ุชุฑููุจ ูุงููุฑุงุช ุงููุฑุงูุจุฉ', 161),
  
  -- ุฃุฎุฑู
  ('other', 'ุฃุฎุฑู', 'Other', 'ุฏฺฏุฑ', 'Grid3x3', '๐ฆ', 'ุฎุฏูุงุช ูุชููุนุฉ ุฃุฎุฑู', 999);

-- ุฎุทูุฉ 4: ุฅุนุงุฏุฉ ุฅูุดุงุก ุฌุฏูู request_categories
CREATE TABLE request_categories (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  request_id UUID NOT NULL REFERENCES requests(id) ON DELETE CASCADE,
  category_id TEXT NOT NULL REFERENCES categories(id) ON DELETE CASCADE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(request_id, category_id)
);

-- ุฎุทูุฉ 5: ุฅูุดุงุก Indexes
CREATE INDEX IF NOT EXISTS idx_categories_active ON categories(is_active) WHERE is_active = TRUE;
CREATE INDEX IF NOT EXISTS idx_categories_sort ON categories(sort_order);
CREATE INDEX IF NOT EXISTS idx_request_categories_request ON request_categories(request_id);
CREATE INDEX IF NOT EXISTS idx_request_categories_category ON request_categories(category_id);

-- ุฎุทูุฉ 6: RLS Policies
ALTER TABLE categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE request_categories ENABLE ROW LEVEL SECURITY;

-- ุงูุณูุงุญ ููุฌููุน ุจูุฑุงุกุฉ ุงูุชุตูููุงุช ุงููุดุทุฉ
DROP POLICY IF EXISTS "Anyone can view categories" ON categories;
CREATE POLICY "Anyone can view categories" ON categories
  FOR SELECT USING (is_active = TRUE);

-- ุงูุณูุงุญ ูููุณุชุฎุฏููู ุงููุณุฌููู ุจูุฑุงุกุฉ request_categories
DROP POLICY IF EXISTS "Users can view request categories" ON request_categories;
CREATE POLICY "Users can view request categories" ON request_categories
  FOR SELECT USING (true);

-- ุงูุณูุงุญ ูููุณุชุฎุฏููู ุจุฅุถุงูุฉ ุชุตูููุงุช ูุทูุจุงุชูู
DROP POLICY IF EXISTS "Users can insert request categories" ON request_categories;
CREATE POLICY "Users can insert request categories" ON request_categories
  FOR INSERT WITH CHECK (
    EXISTS (
      SELECT 1 FROM requests WHERE requests.id = request_id AND requests.author_id = auth.uid()
    )
  );

-- ุฅุถุงูุฉ ุงูุฌุฏูู ููู Realtime
ALTER PUBLICATION supabase_realtime ADD TABLE categories;

-- ==========================================
-- ุชู ุฅูุดุงุก ุงูุชุตูููุงุช ุจูุฌุงุญ!
-- ==========================================

